{% extends "base.html" %}

{% load static %}

{% block content %}
<div class="header">{{ budget.name }}</div>
<div class="container">
    <div class="card">
        <h2>Overview</h2>
        <p><strong>Total Income:</strong> {{ total_income }}</p>
        <p><strong>Total Expense:</strong> {{ total_expense }}</p>
        <p><strong>Balance:</strong> {{ balance }}</p>
    </div>

    <div class="card">
        <h2>Incomes</h2>
        <ul>
            {% for income in incomes %}
                <li>{{ income.description }} - {{ income.amount }}</li>
            {% endfor %}
        </ul>
        <a href="{% url 'add_income' budget.id %}">
            <button>Add Income</button>
        </a>
    </div>

    <div class="card">
        <h2>Expenses</h2>
        <ul>
            {% for expense in expenses %}
                <li>{{ expense.description }} - {{ expense.amount }}</li>
            {% endfor %}
        </ul>
        <a href="{% url 'add_expense' budget.id %}">
            <button>Add Expense</button>
        </a>
    </div>

    <div class="card">
        <h2>Income Breakdown</h2>
        <canvas id="incomeChart"></canvas>
    </div>

    <div class="card">
        <h2>Expense Breakdown</h2>
        <canvas id="expenseChart"></canvas>
    </div>

    <a href="{% url 'dashboard' %}">‚Üê Back to Dashboard</a>
</div>
<script>
    // Income Chart
    var incomeCtx = document.getElementById('incomeChart').getContext('2d');
    var incomeChart = new Chart(incomeCtx, {
        type: 'pie',
        data: {
            labels: [{% for income in incomes %}'{{ income.description }}'{% if not forloop.last %}, {% endif %}{% endfor %}],
            datasets: [{
                data: [{% for income in incomes %}{{ income.amount }}{% if not forloop.last %}, {% endif %}{% endfor %}],
                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF'],
            }]
        },
    });

    // Expense Chart
    var expenseCtx = document.getElementById('expenseChart').getContext('2d');
    var expenseChart = new Chart(expenseCtx, {
        type: 'pie',
        data: {
            labels: [{% for expense in expenses %}'{{ expense.description }}'{% if not forloop.last %}, {% endif %}{% endfor %}],
            datasets: [{
                data: [{% for expense in expenses %}{{ expense.amount }}{% if not forloop.last %}, {% endif %}{% endfor %}],
                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF'],
            }]
        },
    });
</script>
{% endblock %}
